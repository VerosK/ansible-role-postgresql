---
# tasks file for postgresql

- name: apt-get update
  apt: update_cache=yes cache_valid_time=3600
  notify: restart postgresql
  tags: postgresql

- name: apt-get install
  apt: name={{ item }} state=latest
  with_items:
    - postgresql
    - python-psycopg2
  notify: restart postgresql
  tags: postgresql

- name: create postgresql user
  become: yes
  become_user: postgres
  postgresql_user:
    name={{ postgresql_username }}
    password={{ postgresql_password }}
    db={{ postgresql_database }}
  tags: postgresql

- name: create postgresql db
  become: yes
  become_user: postgres
  postgresql_db:
    name={{ postgresql_database }}
    owner={{ postgresql_username }}
    encoding={{ postgresql_encoding }}
    lc_collate={{ postgresql_lc_collate }}
    lc_ctype={{ postgresql_lc_ctype }}
    template={{ postgresql_template }}
  tags: postgresql

- name: enable service
  service: name=postgresql enabled=yes
  notify: restart postgresql
  tags: postgresql
